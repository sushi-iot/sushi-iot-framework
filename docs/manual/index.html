
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../getting_started/">
      
      
        <link rel="next" href="../coding/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Manual - Sushi IoT Framework</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sushi-iot-framework-software-manual" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Sushi IoT Framework" class="md-header__button md-logo" aria-label="Sushi IoT Framework" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sushi IoT Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Manual
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Sushi IoT Framework" class="md-nav__button md-logo" aria-label="Sushi IoT Framework" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Sushi IoT Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Manual
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Manual
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#coding" class="md-nav__link">
    <span class="md-ellipsis">
      Coding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrated-tasks-components" class="md-nav__link">
    <span class="md-ellipsis">
      Integrated tasks &amp; components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integrated tasks &amp; components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wi-fi-management" class="md-nav__link">
    <span class="md-ellipsis">
      Wi-fi management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Web interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-setup" class="md-nav__link">
    <span class="md-ellipsis">
      System setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#factory-restore" class="md-nav__link">
    <span class="md-ellipsis">
      Factory restore
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-events" class="md-nav__link">
    <span class="md-ellipsis">
      Log &amp; Events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-health-monitor" class="md-nav__link">
    <span class="md-ellipsis">
      System health &amp; monitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-device-interface" class="md-nav__link">
    <span class="md-ellipsis">
      On-device interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modem-management" class="md-nav__link">
    <span class="md-ellipsis">
      Modem management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature-sensor" class="md-nav__link">
    <span class="md-ellipsis">
      Temperature sensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Data manager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      System parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-module" class="md-nav__link">
    <span class="md-ellipsis">
      SYSTEM MODULE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wifi-module" class="md-nav__link">
    <span class="md-ellipsis">
      WIFI MODULE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-compatibility-pinout" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware compatibility &amp; pinout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issue-remarks" class="md-nav__link">
    <span class="md-ellipsis">
      Issue &amp; Remarks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Issue &amp; Remarks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#differences-vs-micropython" class="md-nav__link">
    <span class="md-ellipsis">
      Differences vs MicroPython
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#known-bugs" class="md-nav__link">
    <span class="md-ellipsis">
      Known bugs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../coding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MicroPython coding
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/sushi-iot/sushi-iot-framework" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Github repo
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://sushi-iot.github.io/sushi-iot-board/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sushi Board
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#coding" class="md-nav__link">
    <span class="md-ellipsis">
      Coding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrated-tasks-components" class="md-nav__link">
    <span class="md-ellipsis">
      Integrated tasks &amp; components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integrated tasks &amp; components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wi-fi-management" class="md-nav__link">
    <span class="md-ellipsis">
      Wi-fi management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Web interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-setup" class="md-nav__link">
    <span class="md-ellipsis">
      System setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#factory-restore" class="md-nav__link">
    <span class="md-ellipsis">
      Factory restore
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-events" class="md-nav__link">
    <span class="md-ellipsis">
      Log &amp; Events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-health-monitor" class="md-nav__link">
    <span class="md-ellipsis">
      System health &amp; monitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-device-interface" class="md-nav__link">
    <span class="md-ellipsis">
      On-device interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modem-management" class="md-nav__link">
    <span class="md-ellipsis">
      Modem management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature-sensor" class="md-nav__link">
    <span class="md-ellipsis">
      Temperature sensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Data manager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      System parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-module" class="md-nav__link">
    <span class="md-ellipsis">
      SYSTEM MODULE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wifi-module" class="md-nav__link">
    <span class="md-ellipsis">
      WIFI MODULE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-compatibility-pinout" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware compatibility &amp; pinout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issue-remarks" class="md-nav__link">
    <span class="md-ellipsis">
      Issue &amp; Remarks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Issue &amp; Remarks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#differences-vs-micropython" class="md-nav__link">
    <span class="md-ellipsis">
      Differences vs MicroPython
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#known-bugs" class="md-nav__link">
    <span class="md-ellipsis">
      Known bugs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="sushi-iot-framework-software-manual"><strong>Sushi-IoT-Framework Software Manual</strong></h1>
<p>This guide refers to the Sushi-IoT-Framework <a href="https://github.com/sushi-iot/sushi-iot-framework/tree/main/firmware">latest firmware versions</a>.</p>
<hr />
<h2 id="coding"><strong>Coding</strong></h2>
<p>Sushi-IoT-Framework embeds the MicroPython REPL interface, for coding refer to the <a href="../coding/">Sushi-IoT-Framework coding</a>.</p>
<hr />
<h2 id="integrated-tasks-components"><strong>Integrated tasks &amp; components</strong></h2>
<p>Sushi-IoT-Framework integrates some common system tasks and software components that can be useful to speed up development.</p>
<table>
<thead>
<tr>
<th>Task name</th>
<th>Description</th>
<th>Requirements</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#wi-fi-management">Wi-Fi</a></td>
<td>Wi-Fi network connection management</td>
<td>ESP32 chip only</td>
</tr>
<tr>
<td><a href="#web-interface">Web interface</a></td>
<td>Web user interface accessible by a browser</td>
<td>ESP32 chip only</td>
</tr>
<tr>
<td><a href="#system-setup">Setup</a></td>
<td>System setup via configuration file</td>
<td>ESP32 chip only</td>
</tr>
<tr>
<td><a href="#log-events">Log &amp; Events</a></td>
<td>System log and event register management</td>
<td>ESP32 chip only</td>
</tr>
<tr>
<td><a href="#system-health-monitor">System health</a></td>
<td>Monitor system status.<br>Log traces, store to file, and send device status remotely.<br>Manage status LEDs</td>
<td>- (OPTIONAL) External LEDs <br>- (OPTIONAL) Voltage divider for ADC inputs to read battery level and power status</td>
</tr>
<tr>
<td><a href="#on-device-interface">On-device interface</a></td>
<td>On-device user interface with screen and keypad</td>
<td>- 4-button keypad <br>- OLED screen</td>
</tr>
<tr>
<td><a href="#modem-management">Modem</a></td>
<td>Modem management to enable high-level functions like sending/receiving SMS, performing HTTP GET/POST</td>
<td>Modem module</td>
</tr>
<tr>
<td><a href="#temperature-sensor">Temperature</a></td>
<td>Manage temperature sensors</td>
<td>Temperature sensor</td>
</tr>
<tr>
<td><a href="#data-manager">Data manager</a></td>
<td>Manage and send data remotely via HTTP POST, switching automatically between Wi-Fi and modem</td>
<td>- (OPTIONAL) Modem</td>
</tr>
</tbody>
</table>
<!-- Radar | Experimental task for radar management | Radar -->

<hr />
<h3 id="wi-fi-management"><strong>Wi-fi management</strong></h3>
<p>The wi-fi management let setup the device to work in 2 ways:</p>
<ul>
<li>Act as wi-fi access point</li>
<li>Connect to am existing wi-fi network</li>
</ul>
<p>The setup can be done by the web-interface.</p>
<p><strong>Default network settings</strong></p>
<ul>
<li><em>Wi-fi mode</em>: Access point</li>
<li><em>Network SSID</em>: "Sushi-..."</li>
<li><em>Network password</em>: ""</li>
<li><em>IP address</em>: <em>192.168.1.100</em></li>
</ul>
<p><strong>Extra functions</strong></p>
<ul>
<li>
<p>It is always possible to <strong>force the Wi-Fi to run in access point mode</strong> by holding the designated button for about 15 seconds.<br />
This does not reset the device to factory settings: it only forces Wi-Fi to start in AP mode with default network settings (IP address <code>192.168.1.100</code> and no password).<br />
At the next reboot, the device will start according to the saved configuration.<br />
The specific button depends on the CPU board:</p>
<blockquote>
<ul>
<li>ESP32DevKitC board: use the onboard "BOOT" button.</li>
</ul>
</blockquote>
</li>
<li>
<p>The system parameter <em>powersave_time_wifi_off_min</em> defines the timeout (in minutes). <br />
If the device cannot connect to the configured Wi-Fi network (or, in AP mode, no client is connected) for longer than this time, the wireless hardware is switched off to save energy.<br />
Reconnection can then be done either by restarting the device or using the on-device interface.</p>
</li>
</ul>
<hr />
<h3 id="web-interface"><strong>Web interface</strong></h3>
<p>The web interface is divided into the following sections:</p>
<ul>
<li><strong>SETTINGS</strong>: contains all system settings  </li>
<li><strong>STATUS</strong>: displays system information  </li>
</ul>
<p>Access is protected by user levels with 3 profiles. HTTPS is supported (default is HTTP).  </p>
<p><strong>Default users</strong></p>
<table>
<thead>
<tr>
<th>User name</th>
<th>Grants</th>
<th>Default password</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>user</em></td>
<td>Read-only access</td>
<td>"1234"</td>
</tr>
<tr>
<td><em>admin</em></td>
<td>Read-write access with some limitations</td>
<td>"2801"</td>
</tr>
<tr>
<td><em>root</em></td>
<td>Full read-write access including system updates</td>
<td>"1976"</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="system-setup"><strong>System setup</strong></h3>
<p>The Sushi-IoT Framework can be configured either through the web interface or via the MicroPython REPL interface.<br />
Basic settings are available as user controls directly in the web interface, while <em>all</em> settings (both basic and advanced) can be managed through a configuration file.<br />
This configuration file can be saved or loaded from the web UI using the controls at the bottom of the <em>Settings</em> section, and it can also be accessed from the MicroPython file system and API.</p>
<h4 id="factory-restore"><strong>Factory restore</strong></h4>
<ul>
<li>If you lose Wi-Fi connection and just need to access the web UI, you can force AP mode by pressing the dedicated onboard button (see <a href="./#wi-fi-management">Wi-Fi extra functions</a>).  </li>
<li>A full factory restore can be performed by sending a command from the MicroPython REPL, see <a href="../coding/">Sushi-IoT-Framework coding</a>.  </li>
</ul>
<hr />
<h3 id="log-events"><strong>Log &amp; Events</strong></h3>
<p>System log and events can be useful to monitor &amp; debug the system working. 
Both can be accessed by the web-interface in the status page. Log can be enabled even from the MicroPython REPL interface. 
Logs are cleared at every system restart while events are stored into a file. The max events file size is defined by the configuration parameter <em>event_register_size_kb</em>.</p>
<hr />
<h3 id="system-health-monitor"><strong>System health &amp; monitor</strong></h3>
<p>System health is a component useful to monitor the device status in different ways:</p>
<ul>
<li>Read the battery level and main power supply status. Require to connect battery and power to 2 ADC input with proper external resistor divider. For pinout details see <a href="https://sushi-iot.github.io/sushi-iot-board/hardware">Sushi-board</a> or your board hardware manual. Configuration parameter: <em>battery_enable</em></li>
<li>Trace to log the system status (configuration parameter <em>system_info_log_frequency_min</em>).</li>
<li>Store to file the system status (configuration parameters <em>system_info_store_frequency_min</em> and <em>system_info_csv_filter</em>).</li>
<li>Send remotely the device status by http POST. Useful for example to monitor remotely an IoT device. This function requires setting the parameters <em>system_info_send_http_post_frequency_min</em> (frequency) and <em>http_post_delivery_address</em> (destination). </li>
<li>Manage status LEDs. Let monitor the status by LEDs connected to the device.  <blockquote>
<ul>
<li>System status: function enabled by <em>system_status_led</em> parameter. 1 slow blink indicates OK, otherwise it's an error state. <!-- UPG:led codes details  --></li>
<li>Wi-Fi status: function enabled by <em>wifi_status_led</em> parameter. 1 slow blink indicates client connected; quick continuous blink indicates access point mode; otherwise it's an error state. <!-- UPG:led codes details  --></li>
</ul>
</blockquote>
</li>
</ul>
<hr />
<h3 id="on-device-interface"><strong>On-device interface</strong></h3>
<p>This component manages a system menu accessible by a screen and a keypad directly on the device.<br />
Basically the following submenus are present:</p>
<ul>
<li>Diagnostic: several diagnostic info about the device, like battery level, temperature, etc.</li>
<li>System info: versions and date-time info.</li>
<li>Wi-Fi: Wi-Fi connection status, IP, option to force Wi-Fi off or in access point mode.</li>
<li>Modem: modem status and network info.</li>
</ul>
<p>Configuration parameters: <em>keyboard_enable</em>, <em>lcd_enable</em>, <em>ioex_enable</em>.</p>
<p>The standard menu management uses a 4 buttons keyboard (<em>keyboard_enable</em> = 4) to navigate: <em>NEXT</em>, <em>PREVIOUS</em>, <em>BACK</em>, <em>ENTER</em>.</p>
<p>The menu can be extended with application specific submenus by <a href="../coding/">Sushi-IoT-Framework coding</a>.</p>
<hr />
<h3 id="modem-management"><strong>Modem management</strong></h3>
<p>Modem management component:</p>
<ul>
<li>Perform the background tasks to manage the modem by AT commands, including SIM management (PIN, SMS center, APN, etc.). This includes a quite reliable monitor of the modem status, performing all the actions to keep the modem always available and working properly. To achieve maximum reliability, it is recommended to also connect the MOS-controlled modem power control.</li>
<li>Enable the Sushi-IoT-Framework API to easily perform high-level functions like send/receive SMS, perform HTTP GET/POST, and trigger actions when calls from certain numbers are received. See <a href="../coding/">Sushi-IoT-Framework coding</a>.</li>
</ul>
<p>Anyone who worked on low-level modem management knows how tricky it can be to perform all the required tasks reliably. This component makes common operations quite easy.</p>
<hr />
<h3 id="temperature-sensor"><strong>Temperature sensor</strong></h3>
<p>This component simply manages one or more temperature sensors that can be read in different ways: in the system status, in the user menus, or via <a href="../coding/">Sushi-IoT-Framework coding</a>.<br />
Configuration parameter: <em>ext_temperature_sensor_enable</em>.</p>
<hr />
<h3 id="data-manager"><strong>Data manager</strong></h3>
<p>In an IoT application it is common to have data to send remotely to some server (e.g., sensor data or alarms). This component manages all the tasks:</p>
<ul>
<li>Send data by HTTP POST.</li>
<li>Put the data into a queue to manage multiple requests simultaneously.</li>
<li>Manage different retries in case of errors.</li>
<li>Try Wi-Fi if available; if not, switch automatically to use the modem (which requires a completely different and tricky management).</li>
<li>Finally, fire a callback to give feedback when the process ends.</li>
</ul>
<p>The Sushi-IoT-Framework API provides an interface to this component, simplifying the process with minimal effort.<br />
Configuration parameters: <em>http_post_delivery_address</em>, <em>use_wifi_for_http_post</em>.</p>
<hr />
<h2 id="system-parameters"><strong>System parameters</strong></h2>
<p>To display a brief list with all parameters call the <code>sushi_utils.help(...)</code> function from the MicroPython REPL.</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sushi_utils</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>

   <span class="o">...</span>

<span class="c1">### AVAILABLE MODULES ###</span>
  <span class="o">*</span> <span class="s1">&#39;SYSTEM&#39;</span>
  <span class="o">*</span> <span class="s1">&#39;WIFI&#39;</span>

<span class="n">Call</span> <span class="n">help</span><span class="p">(</span><span class="s1">&#39;MODULE&#39;</span><span class="p">)</span> <span class="n">to</span> <span class="n">see</span> <span class="n">parameters</span> <span class="n">of</span> <span class="n">a</span> <span class="n">module</span>
</code></pre></div>

<h3 id="system-module"><strong>SYSTEM MODULE</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sushi_utils</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="s1">&#39;SYSTEM&#39;</span><span class="p">)</span>

<span class="c1">### Parameters for module &#39;SYSTEM&#39;:</span>

<span class="c1">## SYSTEM-CONFIG params</span>
<span class="o">*</span> <span class="n">device_name</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Device</span> <span class="n">name</span><span class="o">/</span><span class="n">description</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span>
<span class="o">*</span> <span class="n">data_file_version</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Configuration</span> <span class="n">file</span> <span class="n">version</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span>

<span class="c1">## SYSTEM-DATETIME params</span>
<span class="o">*</span> <span class="n">time_zone_hours</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Time</span> <span class="n">zone</span> <span class="n">offset</span> <span class="kn">from</span><span class="w"> </span><span class="nn">UTC</span>
  <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mi">12</span><span class="err">…</span><span class="o">+</span><span class="mi">14</span>
<span class="o">*</span> <span class="n">time_auto_daylight_save_change</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">automatic</span> <span class="n">daylight</span> <span class="n">saving</span> <span class="n">change</span> <span class="p">(</span><span class="n">European</span> <span class="n">rules</span><span class="p">)</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">disabled</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">enabled</span>
<span class="o">*</span> <span class="n">ntp_server_address</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">NTP</span> <span class="n">server</span> <span class="n">address</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Example</span><span class="p">:</span> <span class="s1">&#39;pool.ntp.org&#39;</span>

<span class="c1">## HARDWARE-SETUP params</span>
<span class="o">*</span> <span class="n">board_model</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Board</span> <span class="n">model</span><span class="o">.</span> <span class="n">Call</span> <span class="s1">&#39;sushi_utils.pinout()&#39;</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="n">pinout</span><span class="o">.</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">ESP32</span><span class="o">-</span><span class="n">DevKitC</span> <span class="n">on</span> <span class="n">Sushi</span> <span class="n">Board</span>
<span class="o">*</span> <span class="n">ioex_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">expander</span> <span class="n">management</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">PCF8575</span>
<span class="o">*</span> <span class="n">ext_temperature_sensor_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">temperature</span> <span class="n">sensor</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">DS18B20</span>
<span class="o">*</span> <span class="n">rele_out_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">relay</span> <span class="n">outputs</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mf">1..2</span><span class="o">=</span><span class="n">number</span> <span class="n">of</span> <span class="n">relays</span>
<span class="o">*</span> <span class="n">keyboard_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">keypad</span> <span class="n">management</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mf">1.</span><span class="o">..</span><span class="n">N</span><span class="o">=</span><span class="n">N</span> <span class="n">keys</span> <span class="n">on</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="o">-</span><span class="n">Expander</span><span class="p">;</span><span class="mi">100</span><span class="o">=</span><span class="mi">4</span> <span class="n">keys</span> <span class="n">on</span> <span class="n">GPIN</span>
<span class="o">*</span> <span class="n">lcd_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">display</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">OLED_SSD1306</span>
<span class="o">*</span> <span class="n">buzzer_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">buzzer</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">buzzer</span> <span class="n">enabled</span>
<span class="o">*</span> <span class="n">battery_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Battery</span> <span class="n">level</span> <span class="nb">range</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">reserved</span><span class="p">;</span><span class="mi">2</span><span class="o">=</span><span class="mi">1</span> <span class="n">li</span><span class="o">-</span><span class="n">ion</span> <span class="n">cell</span> <span class="p">(</span><span class="mi">1</span><span class="n">S</span><span class="p">)</span> <span class="o">~</span><span class="mf">3.0</span><span class="err">–</span><span class="mf">4.2</span><span class="n">V</span><span class="p">;</span><span class="mi">3</span><span class="o">=</span><span class="mi">3</span> <span class="n">li</span><span class="o">-</span><span class="n">ion</span> <span class="n">cells</span> <span class="p">(</span><span class="mi">3</span><span class="n">S</span><span class="p">)</span> <span class="o">~</span><span class="mi">9</span><span class="err">–</span><span class="mf">12.6</span><span class="n">V</span>

<span class="c1">## SYSTEM-HEALTH&amp;MONITOR params</span>
<span class="o">*</span> <span class="n">event_register_size_kb</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Event</span> <span class="n">register</span> <span class="n">file</span> <span class="n">size</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">no</span> <span class="n">event</span> <span class="n">file</span><span class="p">;</span><span class="n">N</span><span class="o">=</span><span class="n">Max</span> <span class="n">KB</span>
<span class="o">*</span> <span class="n">system_info_log_frequency_min</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">System</span> <span class="n">info</span> <span class="n">log</span> <span class="n">frequency</span> <span class="p">(</span><span class="n">minutes</span><span class="p">)</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">never</span><span class="p">;</span><span class="n">N</span><span class="o">=</span><span class="n">minutes</span>
<span class="o">*</span> <span class="n">system_info_store_frequency_min</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">System</span> <span class="n">info</span> <span class="n">storage</span> <span class="n">frequency</span> <span class="p">(</span><span class="n">minutes</span><span class="p">)</span><span class="o">.</span> <span class="n">Requires</span> <span class="n">system_info_csv_filter</span><span class="o">.</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">never</span><span class="p">;</span><span class="n">N</span><span class="o">=</span><span class="n">minutes</span>
<span class="o">*</span> <span class="n">system_info_csv_filter</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Filter</span> <span class="k">for</span> <span class="n">system</span> <span class="n">status</span> <span class="n">entries</span> <span class="n">stored</span> <span class="n">when</span> <span class="n">system_info_store_frequency_min</span> <span class="err">≠</span> <span class="mi">0</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="p">:</span> <span class="s1">&#39;&lt;entry_info_1&gt;*&lt;entry_info_2&gt;*...&#39;</span>
<span class="o">*</span> <span class="n">system_info_send_http_post_frequency_min</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">HTTP</span> <span class="n">POST</span> <span class="n">system</span> <span class="n">info</span> <span class="n">frequency</span> <span class="p">(</span><span class="n">minutes</span><span class="p">)</span><span class="o">.</span> <span class="n">Posts</span> <span class="n">are</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">http_post_delivery_address</span><span class="o">.</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">never</span><span class="p">;</span><span class="n">N</span><span class="o">=</span><span class="n">minutes</span>

<span class="c1">## SYSTEM-INTERFACE params</span>
<span class="o">*</span> <span class="n">wifi_status_led</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Assign</span> <span class="n">wi</span><span class="o">-</span><span class="n">fi</span> <span class="n">status</span> <span class="n">to</span> <span class="n">an</span> <span class="n">external</span> <span class="n">LED</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="p">:</span> <span class="s1">&#39;GPIO_1..N&#39;</span><span class="p">,</span> <span class="s1">&#39;GPO_1..N&#39;</span> <span class="o">-</span> <span class="n">see</span> <span class="n">HW</span> <span class="n">pinout</span>
<span class="o">*</span> <span class="n">system_status_led</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Assign</span> <span class="n">system</span> <span class="n">status</span> <span class="n">to</span> <span class="n">an</span> <span class="n">external</span> <span class="n">LED</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="p">:</span> <span class="s1">&#39;GPIO_1..N&#39;</span><span class="p">,</span> <span class="s1">&#39;GPO_1..N&#39;</span> <span class="o">-</span> <span class="n">see</span> <span class="n">HW</span> <span class="n">pinout</span>
<span class="o">*</span> <span class="n">modem_status_led</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Assign</span> <span class="n">modem</span> <span class="n">status</span> <span class="n">to</span> <span class="n">an</span> <span class="n">external</span> <span class="n">LED</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="p">:</span> <span class="s1">&#39;GPIO_1..N&#39;</span><span class="p">,</span> <span class="s1">&#39;GPO1..N&#39;</span> <span class="o">-</span> <span class="n">see</span> <span class="n">HW</span> <span class="n">pinout</span>

<span class="c1">## HTTP-DATA-MANAGER params</span>
<span class="o">*</span> <span class="n">http_post_delivery_address</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Server</span> <span class="n">address</span> <span class="k">for</span> <span class="n">HTTP</span> <span class="n">POST</span><span class="o">.</span> <span class="n">Custom</span> <span class="n">application</span><span class="o">-</span><span class="n">specific</span> <span class="n">data</span> <span class="n">can</span> <span class="n">be</span> <span class="n">sent</span> <span class="n">by</span> <span class="n">the</span> <span class="n">Sushi</span><span class="o">-</span><span class="n">IoT</span><span class="o">-</span><span class="n">Framework</span> <span class="n">API</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Example</span><span class="p">:</span> <span class="s1">&#39;https://your_web_server/post_data.php&#39;</span>
<span class="o">*</span> <span class="n">use_wifi_for_http_post</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Use</span> <span class="n">wi</span><span class="o">-</span><span class="n">fi</span> <span class="n">before</span> <span class="n">modem</span> <span class="k">for</span> <span class="n">HTTP</span> <span class="n">POST</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">disabled</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">enabled</span>

<span class="c1">## MODEM params</span>
<span class="o">*</span> <span class="n">modem_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">modem</span> <span class="n">management</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">none</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">SIMCOM7672X</span>
<span class="o">*</span> <span class="n">modem_sim_sms_center</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">SIM</span> <span class="n">SMS</span> <span class="n">center</span> <span class="n">number</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Example</span><span class="p">:</span> <span class="s1">&#39;+393519999600&#39;</span>
<span class="o">*</span> <span class="n">modem_sim_pin</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">SIM</span> <span class="n">PIN</span> <span class="n">code</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Example</span><span class="p">:</span> <span class="s1">&#39;1234&#39;</span>
<span class="o">*</span> <span class="n">modem_apn</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">SIM</span> <span class="n">APN</span> <span class="n">name</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Example</span><span class="p">:</span> <span class="s1">&#39;iliad&#39;</span>
<span class="o">*</span> <span class="n">modem_user</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">APN</span> <span class="n">user</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Optional</span>
<span class="o">*</span> <span class="n">modem_passwd</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">APN</span> <span class="n">password</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span><span class="o">.</span> <span class="n">Optional</span>

<span class="c1">## DEBUG-EXPERIMENTAL-RESERVED params</span>
<span class="o">*</span> <span class="n">powersave_time_wifi_off_min</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Auto</span> <span class="n">wi</span><span class="o">-</span><span class="n">fi</span> <span class="n">power</span><span class="o">-</span><span class="n">off</span> <span class="n">after</span> <span class="n">inactivity</span> <span class="p">(</span><span class="n">minutes</span><span class="p">)</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">disabled</span><span class="p">;</span><span class="n">N</span><span class="o">=</span><span class="n">minutes</span>
<span class="o">*</span> <span class="n">debug_mode</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Debug</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">extension_modules</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">extra</span> <span class="n">experimental</span> <span class="n">modules</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">Reserved</span>

<span class="c1">## Online help:&#39;https://sushi-iot.github.io/sushi-iot-framework/&#39;</span>
</code></pre></div>

<h3 id="wifi-module"><strong>WIFI MODULE</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sushi_utils</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="s1">&#39;WIFI&#39;</span><span class="p">)</span>

<span class="c1">### Parameters for module &#39;WIFI&#39;:</span>

<span class="c1">## COMMON params</span>
<span class="o">*</span> <span class="n">wifi_mode</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Wifi</span> <span class="n">mode</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">Disabled</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">Client</span><span class="p">;</span><span class="mi">2</span><span class="o">=</span><span class="n">Access</span> <span class="n">point</span>
<span class="o">*</span> <span class="n">ip</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">IP</span> <span class="n">address</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">string</span>
<span class="o">*</span> <span class="n">subnet</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Subnet</span> <span class="n">mask</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">string</span>
<span class="o">*</span> <span class="n">gateway</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Gateway</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">string</span>

<span class="c1">## WIFI-CLIENT-MODE params</span>
<span class="o">*</span> <span class="n">cli_ssid</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Network</span> <span class="n">SSID</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span>
<span class="o">*</span> <span class="n">cli_passwd</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Network</span> <span class="n">password</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span>
<span class="o">*</span> <span class="n">cli_dhcp_enable</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Enable</span> <span class="n">DHCP</span> <span class="n">client</span>
  <span class="n">Values</span><span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">disabled</span><span class="p">;</span><span class="mi">1</span><span class="o">=</span><span class="n">enabled</span>
<span class="o">*</span> <span class="n">cli_dns_address</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">string</span>

<span class="c1">## WIFI-ACCESS-POINT-MODE params</span>
<span class="o">*</span> <span class="n">ap_passwd</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Access</span> <span class="n">point</span> <span class="n">password</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span>
<span class="o">*</span> <span class="n">ap_channel</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Access</span> <span class="n">point</span> <span class="n">channel</span>
  <span class="n">Values</span><span class="p">:</span> <span class="n">String</span>

<span class="c1">## Online help:&#39;https://sushi-iot.github.io/sushi-iot-framework/&#39;</span>
</code></pre></div>

<hr />
<h2 id="hardware-compatibility-pinout"><strong>Hardware compatibility &amp; pinout</strong></h2>
<p>Some of the tasks integrated into the Sushi-IoT Framework manage external hardware, so it's important to know which pins of the microcontroller are used to connect the external devices.</p>
<p>The base platform is always an ESP32 SoC, but the exact pin mapping used to control external peripherals depends on the specific board you're using.<br />
To display a brief table with all board-specific pins, call the <code>sushi_utils.pinout()</code> function from the MicroPython REPL.</p>
<p><strong>Show boards list</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span><span class="n">sushi_utils</span><span class="o">.</span><span class="n">pinout</span><span class="p">()</span>
  <span class="n">Available</span> <span class="n">boards</span><span class="p">:</span>
<span class="o">*</span>  <span class="n">ID</span> <span class="mi">0</span><span class="p">:</span> <span class="n">ESP32</span><span class="o">-</span><span class="n">DevKitC</span> <span class="n">on</span> <span class="n">Sushi</span> <span class="n">Board</span>
</code></pre></div>

<p><strong>Show board specific pinout</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span><span class="n">sushi_utils</span><span class="o">.</span><span class="n">pinout</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  
<span class="o">===</span> <span class="n">ESP32</span><span class="o">-</span><span class="n">DevKitC</span> <span class="n">on</span> <span class="n">Sushi</span> <span class="n">Board</span> <span class="p">[</span><span class="s2">&quot;board_model&quot;</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">0</span><span class="p">]</span> <span class="o">===</span>


<span class="o">*</span> <span class="n">ONLINE</span> <span class="n">DOC</span>
    <span class="o">-&gt;</span> <span class="n">ESP32</span><span class="o">-</span><span class="n">DevKitC</span><span class="p">:</span> <span class="s2">&quot;https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitc/user_guide.html&quot;</span>
    <span class="o">-&gt;</span> <span class="n">Sushi</span> <span class="n">Board</span><span class="p">:</span> <span class="s2">&quot;https://sushi-iot.github.io/sushi-iot-board/&quot;</span>

<span class="c1">### PINOUT</span>

<span class="c1">#system(always present)</span>
<span class="o">*</span> <span class="n">ON</span><span class="o">-</span><span class="n">BOARD</span><span class="o">-</span><span class="n">BUTTON</span><span class="p">:</span> <span class="mi">0</span>
<span class="o">*</span> <span class="n">I2C_SDA_PIN</span><span class="p">:</span><span class="mi">21</span>
<span class="o">*</span> <span class="n">I2C_SCL_PIN</span><span class="p">:</span><span class="mi">22</span>
<span class="o">*</span> <span class="n">REPL_UART1_TX</span><span class="p">:</span><span class="mi">19</span>
<span class="o">*</span> <span class="n">REPL_UART1_RX</span><span class="p">:</span><span class="mi">18</span>
<span class="o">*</span> <span class="n">VIN</span><span class="o">-</span><span class="n">ADC</span><span class="p">:</span><span class="mi">36</span><span class="p">(</span><span class="n">VP</span><span class="p">)</span>

<span class="c1">#GPIO(free I/O pins)</span>
<span class="o">*</span> <span class="n">GPIO_1</span><span class="p">:</span><span class="mi">19</span>
<span class="o">*</span> <span class="n">GPIO_2</span><span class="p">:</span><span class="mi">18</span>
<span class="o">*</span> <span class="n">GPIO_3</span><span class="p">:</span><span class="mi">5</span>
<span class="o">*</span> <span class="n">GPIO_4</span><span class="p">:</span><span class="mi">4</span>
<span class="o">*</span> <span class="n">GPIO_5</span><span class="p">:</span><span class="mi">13</span>
<span class="c1">#GPI(free Input only pins)</span>
<span class="o">*</span> <span class="n">GPI_1</span><span class="p">:</span><span class="mi">39</span><span class="p">(</span><span class="n">VN</span><span class="p">)</span>
<span class="o">*</span> <span class="n">GPI_2</span><span class="p">:</span><span class="mi">35</span>
<span class="c1">#GPO(free Output only pins)</span>
<span class="o">*</span> <span class="n">GPO_1</span><span class="p">:</span><span class="mi">2</span>

<span class="c1">#power(if &#39;battery_enable&#39; &gt; 0)</span>
<span class="o">*</span> <span class="n">BATT</span><span class="o">-</span><span class="n">ADC</span><span class="p">:</span><span class="mi">34</span>

<span class="c1">#modem(if &#39;modem_enable&#39; &gt; 0)</span>
<span class="o">*</span> <span class="n">MODEM_UART_TX</span><span class="p">:</span><span class="mi">27</span>
<span class="o">*</span> <span class="n">MODEM_UART_RX</span><span class="p">:</span><span class="mi">26</span>
<span class="o">*</span> <span class="n">MODEM_PWKEY</span><span class="p">:</span><span class="mi">32</span>
<span class="o">*</span> <span class="n">MODEM_POWER</span><span class="p">:</span><span class="mi">23</span>

<span class="c1">#io-expander(if &#39;ioex_enable&#39; &gt; 0)</span>
<span class="o">*</span> <span class="n">IOEXP_I2C_INT_PIN</span><span class="p">:</span><span class="mi">14</span>

<span class="c1">#direct 4B keyboard(if &#39;keyboard_enable&#39;=100)</span>
<span class="o">*</span> <span class="n">IN_1</span><span class="p">:</span> <span class="n">GPIO_4</span>
<span class="o">*</span> <span class="n">IN_2</span><span class="p">:</span> <span class="n">GPIO_5</span>
<span class="o">*</span> <span class="n">IN_3</span><span class="p">:</span> <span class="n">GPI_1</span>
<span class="o">*</span> <span class="n">IN_4</span><span class="p">:</span> <span class="n">GPI_2</span>

<span class="c1">#relays</span>
<span class="o">*</span> <span class="n">RELE_1_PIN</span><span class="p">:</span><span class="mi">15</span> <span class="p">(</span><span class="k">if</span> <span class="s1">&#39;rele_out_enable&#39;</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="o">*</span> <span class="n">RELE_2_PIN</span><span class="p">:</span><span class="mi">12</span> <span class="p">(</span><span class="k">if</span> <span class="s1">&#39;rele_out_enable&#39;</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#temperature sensor(if &#39;ext_temperature_sensor_enable&#39; &gt; 0)</span>
<span class="o">*</span> <span class="n">DS18B20_DATA</span><span class="p">:</span><span class="mi">33</span>

<span class="c1">#buzzer(if &#39;buzzer_enable&#39; &gt; 0)</span>
<span class="o">*</span> <span class="n">BUZZER_PIN</span><span class="p">:</span><span class="mi">25</span>
</code></pre></div>

<p>For more details, refer to your board’s hardware manual:</p>
<ul>
<li><strong>Sushi-IoT Board:</strong> see the <a href="https://sushi-iot.github.io/sushi-iot-board/hardware">Sushi-IoT Board Hardware Manual</a>.  </li>
<li><strong>Standalone ESP32-DevKitC board:</strong> it uses the same pinout as the Sushi-IoT Board. Start from the microcontroller schematic (ESP32-DevKitC board) to check where the external devices are expected to be connected:<br />
<a href="https://sushi-iot.github.io/sushi-iot-board/hardware#microcontroller-board">Sushi-IoT Board Microcontroller Section</a>.</li>
</ul>
<hr />
<h2 id="issue-remarks"><strong>Issue &amp; Remarks</strong></h2>
<h3 id="differences-vs-micropython"><strong>Differences vs MicroPython</strong></h3>
<p>Sushi-IoT-Framework manages some system/hardware tasks, the following table highlights some points to consider during MicroPython scripting.<br />
This table refers to the latest available version of Sushi-IoT-Framework-MicroPython integration: <a href="https://github.com/sushi-iot/sushi-iot-framework/tree/main/firmware">Sushi-IoT-Framework version</a>.</p>
<table>
<thead>
<tr>
<th>MicroPython module</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>ADC</td>
<td>Disabled. The MicroPython implementation uses an older version of driver that is not compatible with the current Sushi-IoT-Framework ADC management (most recent ESP32 drivers). Reactivate the ADC module is priority one. <!-- UPGRADE in the meantime <a href="link">Sushi-IoT-Framework-ADC-API</a> is available. --></td>
</tr>
<tr>
<td>Wi-Fi</td>
<td>Sushi-IoT Framework manages Wi-Fi connections with all the most common options. Using the native MicroPython Wi-Fi implementation at the same time would cause a conflict, so to do this you first need to disable Wi-Fi in the Sushi-IoT setup (wifi_mode = 0).</td>
</tr>
</tbody>
</table>
<!-- Even though in the current release of Sushi-IoT-Framework there are some limitations, the roadmap is to remove them in future updates, allowing everything to be managed either by MicroPython or by Sushi-IoT-Framework modules.  -->

<hr />
<h3 id="known-bugs"><strong>Known bugs</strong></h3>
<p>During MicroPython testing some bugs arose. The plan is to update the embedded MicroPython implementation to remove them.</p>
<p><strong>MicroPython known bugs</strong></p>
<table>
<thead>
<tr>
<th>MicroPython module</th>
<th>Problem</th>
</tr>
</thead>
<tbody>
<tr>
<td>WebREPL</td>
<td>WebREPL is working but it's an experimental feature. During testing, cases were experienced where it completely blocked the microcontroller (requiring a power cycle).</td>
</tr>
<tr>
<td>time</td>
<td><em>time.localtime()</em> function returns the wrong year. Other fields are correct.</td>
</tr>
</tbody>
</table>
<p><a href="mailto:mo.iot.wiz@gmail.com?subject=Issue%20report">Report an issue to mo.iot.wiz@gmail.com</a></p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>